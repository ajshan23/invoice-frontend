import{r as i,j as e,T as E,e as x,L as N}from"./index-Dn-pTzZV.js";import{P as L}from"./PageTitle-DySgJhFV.js";import{a as P}from"./index-C88pvD_q.js";import{r as $}from"./riyal_icon-CI4jK9IE.js";import{M as n}from"./Modal-DdyQXB8V.js";import{B as r}from"./Button-A263VPWa.js";import{S as V}from"./Spinner-DK3UkTwu.js";import{R as u,C as o}from"./Row-CqvNKYQm.js";import{P as c}from"./Pagination-BZGgjDqY.js";import"./AbstractModalHeader-DI4lGPEG.js";import"./useWindow-BClWek3A.js";import"./usePrevious-sXSJbvm9.js";import"./useEventCallback-DtUHN23g.js";import"./hasClass-DOEMOJ4Z.js";import"./useMergedRefs-B9UIRkjd.js";import"./NoopTransition-qEpoKOor.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-CuRTTgXn.js";import"./Button-Dh52reoe.js";import"./Anchor-7eg_kKsq.js";const oe=()=>{const[g,j]=i.useState([]),[d,A]=i.useState(""),[a,S]=i.useState(1),[p,C]=i.useState(1),[y,_]=i.useState(10),[T,l]=i.useState(!1),[f,D]=i.useState(null),[v,w]=i.useState(!1),[k,b]=i.useState(!1),[I,M]=i.useState(""),[z,R]=i.useState("success");i.useEffect(()=>{(async()=>{try{const s=await P.get(`http://185.199.53.88/api/invoice?page=${a}&limit=${y}&search=${d}`);s.status===200&&(j(s.data.data),C(s.data.pagination.totalPages))}catch(s){console.error("Error fetching PDFs:",s),m("Failed to fetch invoices. Please try again.","danger")}})()},[a,y,d]);const h=t=>{S(t)},F=t=>{D(t),l(!0)},B=async()=>{w(!0);try{(await P.delete(`http://185.199.53.88/api/invoice/${f}`)).status===200&&(j(g.filter(s=>s._id!==f)),m("Invoice deleted successfully!","success"))}catch(t){console.error("Error deleting invoice:",t),m("Failed to delete invoice. Please try again.","danger")}finally{w(!1),l(!1)}},m=(t,s)=>{M(t),R(s),b(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(L,{title:"All PDFs"}),e.jsx(E,{position:"top-end",className:"p-3",children:e.jsxs(x,{onClose:()=>b(!1),show:k,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(x.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(x.Body,{className:"",children:I})]})}),e.jsxs(n,{show:T,onHide:()=>l(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Confirm Delete"})}),e.jsx(n.Body,{children:"Are you sure you want to delete this invoice? This action cannot be undone."}),e.jsxs(n.Footer,{children:[e.jsx(r,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(r,{variant:"danger",onClick:B,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(V,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(u,{children:e.jsx(o,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(u,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(o,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Company Name or Invoice Number",value:d,onChange:t=>A(t.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(o,{xs:"auto",children:e.jsx(r,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:N,to:"/invoice/new",children:"New"})})]}),e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Company Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Invoice Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Items"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Price"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:g.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.companyName}),e.jsx("td",{style:{verticalAlign:"middle"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.invoiceNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.items.length}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx("img",{src:$,width:10,height:12}),t.totalPrice]}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(r,{variant:"info",size:"sm",as:N,to:`/invoice/view/${t._id}`,style:{marginRight:"5px",color:"white"},children:"View"}),e.jsx(r,{variant:"danger",size:"sm",onClick:()=>F(t._id),children:"Delete"})]})]},s))})]})})})})}),e.jsx(u,{className:"mt-3",children:e.jsx(o,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(c,{children:[e.jsx(c.Prev,{onClick:()=>h(a-1),disabled:a===1}),Array.from({length:p},(t,s)=>e.jsx(c.Item,{active:s+1===a,onClick:()=>h(s+1),children:s+1},s+1)),e.jsx(c.Next,{onClick:()=>h(a+1),disabled:a===p})]})})})]})})})]})};export{oe as default};
