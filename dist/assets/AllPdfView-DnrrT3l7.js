import{r as i,j as e,T as E,e as x,L as N}from"./index-CipYN5RM.js";import{P as L}from"./PageTitle-C5Pc3w6l.js";import{a as P}from"./index-C88pvD_q.js";import{r as _}from"./riyal_icon-CI4jK9IE.js";import{b as A}from"./authConstant-CsT3Fd4n.js";import{M as r}from"./Modal-BQKCClms.js";import{B as n}from"./Button-DDpHrx3q.js";import{S as V}from"./Spinner-CWeo7CtG.js";import{R as u,C as o}from"./Row-CNxKcFtr.js";import{P as c}from"./Pagination-BRhus7HM.js";import"./AbstractModalHeader-DpaCij4v.js";import"./useWindow-DUsYlyYs.js";import"./usePrevious-Ib52gaJw.js";import"./useEventCallback-BEOSPGBV.js";import"./hasClass-DbjurgZT.js";import"./useMergedRefs-BKPY77li.js";import"./NoopTransition-DUtAtZ6Z.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-CIEjlYvH.js";import"./Button-BuEOCE5t.js";import"./Anchor-74EgCIcx.js";const de=()=>{const[g,j]=i.useState([]),[d,S]=i.useState(""),[a,C]=i.useState(1),[p,T]=i.useState(1),[y,z]=i.useState(10),[D,l]=i.useState(!1),[f,k]=i.useState(null),[v,b]=i.useState(!1),[I,w]=i.useState(!1),[M,R]=i.useState(""),[H,$]=i.useState("success");i.useEffect(()=>{(async()=>{try{const s=await P.get(`${A}/invoice?page=${a}&limit=${y}&search=${d}`);s.status===200&&(j(s.data.data),T(s.data.pagination.totalPages))}catch(s){console.error("Error fetching PDFs:",s),m("Failed to fetch invoices. Please try again.","danger")}})()},[a,y,d]);const h=t=>{C(t)},F=t=>{k(t),l(!0)},B=async()=>{b(!0);try{(await P.delete(`${A}/invoice/${f}`)).status===200&&(j(g.filter(s=>s._id!==f)),m("Invoice deleted successfully!","success"))}catch(t){console.error("Error deleting invoice:",t),m("Failed to delete invoice. Please try again.","danger")}finally{b(!1),l(!1)}},m=(t,s)=>{R(t),$(s),w(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(L,{title:"All PDFs"}),e.jsx(E,{position:"top-end",className:"p-3",children:e.jsxs(x,{onClose:()=>w(!1),show:I,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(x.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(x.Body,{className:"",children:M})]})}),e.jsxs(r,{show:D,onHide:()=>l(!1),children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Confirm Delete"})}),e.jsx(r.Body,{children:"Are you sure you want to delete this invoice? This action cannot be undone."}),e.jsxs(r.Footer,{children:[e.jsx(n,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(n,{variant:"danger",onClick:B,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(V,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(u,{children:e.jsx(o,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(u,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(o,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Company Name or Invoice Number",value:d,onChange:t=>S(t.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(o,{xs:"auto",children:e.jsx(n,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:N,to:"/invoice/new",children:"New"})})]}),e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Company Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Invoice Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Items"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Price"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:g.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.companyName}),e.jsx("td",{style:{verticalAlign:"middle"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.invoiceNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.items.length}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx("img",{src:_,width:10,height:12}),t.totalPrice]}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(n,{variant:"info",size:"sm",as:N,to:`/invoice/view/${t._id}`,style:{marginRight:"5px",color:"white"},children:"View"}),e.jsx(n,{variant:"danger",size:"sm",onClick:()=>F(t._id),children:"Delete"})]})]},s))})]})})})})}),e.jsx(u,{className:"mt-3",children:e.jsx(o,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(c,{children:[e.jsx(c.Prev,{onClick:()=>h(a-1),disabled:a===1}),Array.from({length:p},(t,s)=>e.jsx(c.Item,{active:s+1===a,onClick:()=>h(s+1),children:s+1},s+1)),e.jsx(c.Next,{onClick:()=>h(a+1),disabled:a===p})]})})})]})})})]})};export{de as default};
