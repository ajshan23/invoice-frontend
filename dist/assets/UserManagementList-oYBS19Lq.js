import{b as Q,u as V,r as t,j as e,T as I,e as y,L as D}from"./index-CQD1z6Fx.js";import{a as v}from"./index-C88pvD_q.js";import{P as q}from"./PageTitle-CtZGw2bx.js";import{S as P,b as E}from"./authConstant-Cc9JzxD5.js";import{M as o}from"./Modal-DLgghu9o.js";import{B as d}from"./Button-C4dcH4PN.js";import{R as b,C as x}from"./Row-DR6tWxXV.js";import{P as m}from"./Pagination-D7ecv7YI.js";import"./AbstractModalHeader-Du6YRHdw.js";import"./useWindow-LUbUsM8M.js";import"./usePrevious-BJGs3ej9.js";import"./useEventCallback-CVZnaNmR.js";import"./hasClass-B8cAOfsz.js";import"./useMergedRefs-3CvEkCm7.js";import"./NoopTransition-lXhKxUDK.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-DI2ioJPZ.js";import"./Button-BXfs0ALN.js";import"./Anchor-uhiCwYfp.js";v.defaults.withCredentials=!0;const me=()=>{const{user:c,isAdmin:j}=Q(),w=V(),[N,A]=t.useState([]),[p,M]=t.useState(""),[i,$]=t.useState(1),[C,G]=t.useState(1),[S,J]=t.useState(10),[R,h]=t.useState(!1),[T,B]=t.useState(null),[g,u]=t.useState(!1),[U,k]=t.useState(!1),[F,_]=t.useState(""),[K,z]=t.useState("success");t.useEffect(()=>{j()||w("/dashboard")},[j,w]),t.useEffect(()=>{const s=async()=>{var a,r;u(!0);try{const n=await v.get(`${E}/user?page=${i}&limit=${S}&search=${p}`,{headers:{Authorization:`Bearer ${c.token}`}});n.status===200?A(n.data.data):l("Failed to fetch users.","danger")}catch(n){console.error("Error fetching users:",n),l(((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.error)||"Failed to fetch users","danger")}finally{u(!1)}};c&&j()&&s()},[i,S,p,c]);const f=s=>{$(s)},L=s=>{B(s),h(!0)},H=async()=>{var s,a;u(!0);try{const r=await v.delete(`${E}/user/${T}`,{headers:{Authorization:`Bearer ${c.token}`}});r.status===200&&r.data.success?(A(N.filter(n=>n._id!==T)),l("User deleted successfully!","success")):l("Failed to delete user.","danger")}catch(r){console.error("Error deleting user:",r),l(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to delete user.","danger")}finally{u(!1),h(!1)}},l=(s,a)=>{_(s),z(a),k(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(q,{title:"User Management"}),e.jsx(I,{position:"top-end",className:"p-3",children:e.jsxs(y,{onClose:()=>k(!1),show:U,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(y.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(y.Body,{className:"",children:F})]})}),e.jsxs(o,{show:R,onHide:()=>h(!1),children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Confirm Delete"})}),e.jsx(o.Body,{children:"Are you sure you want to delete this user? This action cannot be undone."}),e.jsxs(o.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>h(!1),children:"Cancel"}),e.jsx(d,{variant:"danger",onClick:H,disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(P,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(b,{children:e.jsx(x,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(b,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(x,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Name or Email",value:p,onChange:s=>M(s.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(x,{xs:"auto",children:e.jsx(d,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:D,to:"/users/add",children:"Add User"})})]}),g?e.jsx("div",{className:"text-center",children:e.jsx(P,{animation:"border"})}):e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Email"}),e.jsx("th",{style:{textAlign:"center"},children:"Role"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:s.name}),e.jsx("td",{style:{verticalAlign:"middle"},children:s.email}),e.jsx("td",{style:{verticalAlign:"middle"},children:s.role}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(d,{variant:"info",size:"sm",as:D,to:`/users/edit/${s._id}`,style:{marginRight:"5px",color:"white"},children:"Edit"}),e.jsx(d,{variant:"danger",size:"sm",onClick:()=>L(s._id),children:"Delete"})]})]},s._id))})]})})})})}),e.jsx(b,{className:"mt-3",children:e.jsx(x,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(m,{children:[e.jsx(m.Prev,{onClick:()=>f(i-1),disabled:i===1}),Array.from({length:C},(s,a)=>e.jsx(m.Item,{active:a+1===i,onClick:()=>f(a+1),children:a+1},a+1)),e.jsx(m.Next,{onClick:()=>f(i+1),disabled:i===C})]})})})]})})})]})};export{me as default};
