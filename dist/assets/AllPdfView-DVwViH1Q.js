import{b as F,r as a,j as e,T as L,e as u,L as N}from"./index-CQD1z6Fx.js";import{P as _}from"./PageTitle-CtZGw2bx.js";import{a as P}from"./index-C88pvD_q.js";import{r as q}from"./riyal_icon-CI4jK9IE.js";import{S as V,b as C}from"./authConstant-Cc9JzxD5.js";import{M as r}from"./Modal-DLgghu9o.js";import{B as n}from"./Button-C4dcH4PN.js";import{R as g,C as c}from"./Row-DR6tWxXV.js";import{P as d}from"./Pagination-D7ecv7YI.js";import"./AbstractModalHeader-Du6YRHdw.js";import"./useWindow-LUbUsM8M.js";import"./usePrevious-BJGs3ej9.js";import"./useEventCallback-CVZnaNmR.js";import"./hasClass-B8cAOfsz.js";import"./useMergedRefs-3CvEkCm7.js";import"./NoopTransition-lXhKxUDK.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-DI2ioJPZ.js";import"./Button-BXfs0ALN.js";import"./Anchor-uhiCwYfp.js";const he=()=>{const{user:o}=F(),[j,p]=a.useState([]),[h,S]=a.useState(""),[i,T]=a.useState(1),[y,D]=a.useState(1),[f,H]=a.useState(10),[k,l]=a.useState(!1),[v,$]=a.useState(null),[b,w]=a.useState(!1),[B,A]=a.useState(!1),[I,M]=a.useState(""),[Q,R]=a.useState("success");a.useEffect(()=>{o&&(async()=>{try{const s=await P.get(`${C}/quotation?page=${i}&limit=${f}&search=${h}`,{headers:{Authorization:`Bearer ${o.token}`}});s.status===200&&(p(s.data.data),D(s.data.pagination.totalPages))}catch(s){console.error("Error fetching PDFs:",s),m("Failed to fetch invoices. Please try again.","danger")}})()},[i,f,h,o]);const x=t=>{T(t)},z=t=>{$(t),l(!0)},E=async()=>{w(!0);try{(await P.delete(`${C}/quotation/${v}`,{headers:{Authorization:`Bearer ${o.token}`}})).status===200&&(p(j.filter(s=>s._id!==v)),m("Invoice deleted successfully!","success"))}catch(t){console.error("Error deleting invoice:",t),m("Failed to delete invoice. Please try again.","danger")}finally{w(!1),l(!1)}},m=(t,s)=>{M(t),R(s),A(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(_,{title:"All Quotation"}),e.jsx(L,{position:"top-end",className:"p-3",children:e.jsxs(u,{onClose:()=>A(!1),show:B,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(u.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(u.Body,{className:"",children:I})]})}),e.jsxs(r,{show:k,onHide:()=>l(!1),children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Confirm Delete"})}),e.jsx(r.Body,{children:"Are you sure you want to delete this invoice? This action cannot be undone."}),e.jsxs(r.Footer,{children:[e.jsx(n,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(n,{variant:"danger",onClick:E,disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(V,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(g,{children:e.jsx(c,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(g,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(c,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Company Name or Invoice Number",value:h,onChange:t=>S(t.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(c,{xs:"auto",children:e.jsx(n,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:N,to:"/quotation/new",children:"New"})})]}),e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Company Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Invoice Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Items"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Price"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:j.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.companyName}),e.jsx("td",{style:{verticalAlign:"middle"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.invoiceNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.items.length}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx("img",{src:q,width:10,height:12}),t.totalPrice]}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(n,{variant:"info",size:"sm",as:N,to:`/quotation/view/${t._id}`,style:{marginRight:"5px",color:"white"},children:"View"}),e.jsx(n,{variant:"danger",size:"sm",onClick:()=>z(t._id),children:"Delete"})]})]},s))})]})})})})}),e.jsx(g,{className:"mt-3",children:e.jsx(c,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(d,{children:[e.jsx(d.Prev,{onClick:()=>x(i-1),disabled:i===1}),Array.from({length:y},(t,s)=>e.jsx(d.Item,{active:s+1===i,onClick:()=>x(s+1),children:s+1},s+1)),e.jsx(d.Next,{onClick:()=>x(i+1),disabled:i===y})]})})})]})})})]})};export{he as default};
