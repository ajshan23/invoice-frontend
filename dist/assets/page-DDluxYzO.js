import{r as N,u as S,a as y,b as v,c as w,j as e}from"./index-BxSV0Cea.js";import{A as I}from"./AuthLogo-DhT4JGsG.js";import{u as P}from"./index.esm-Df7i3zeV.js";import{o as C,c as L,a as l}from"./index.esm-AADSBrbW.js";import{T as A}from"./TextFormInput-MS5-L-tq.js";import{P as F}from"./PasswordFormInput-GLAl0nZ-.js";import{F as q}from"./Form-D9PoiDuY.js";import{B as R}from"./Button-CW3ssM_5.js";import{S as T}from"./Spinner-CznovaNv.js";import{a as k}from"./auth-img-Z-U4pW7a.js";import{C as D}from"./Container-Bf51CKHn.js";import{R as d,C as t}from"./Row-AV6z3Pke.js";import{C as E}from"./Card-DXO_BJvt.js";import"./logo-B4Xq2_A3.js";import"./logo-dark-B4Xq2_A3.js";import"./FormContext-DL2bZAED.js";import"./FormLabel-BKhAUeCP.js";import"./FormControl--kY58Kua.js";import"./IconifyIcon-CsQS9v5V.js";import"./FormCheck-retqJImb.js";import"./ElementChildren-KII06_FA.js";import"./Button-r8BHYXc-.js";import"./CardHeaderContext-DAnDpvWP.js";import"./divWithClassName-D4rRuIZB.js";const M=L({identifier:l().required("Please enter your Iqama Number or Member ID"),password:l().required("Please enter your password")}),B=()=>{const[n,i]=N.useState(!1),u=S(),[p]=y(),{saveSession:g}=v(),{showNotification:r}=w(),{control:m,handleSubmit:f}=P({resolver:C(M),defaultValues:{identifier:"",password:""}}),x=async h=>{var c;i(!0);try{console.log("Sending login request...");const o=await fetch("http://13.203.184.112:3000/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}),s=await o.json();if(console.log("API Response:",s),o.ok&&(s!=null&&s.success)&&((c=s==null?void 0:s.data)!=null&&c.token)){console.log("Login successful!");const{user:a,token:j}=s.data;if(!a.isAdmin&&!a.isSuperAdmin){r({message:"Access denied! You are not an admin.",variant:"danger"});return}g({token:j,user:a}),r({message:"Successfully logged in. Redirecting....",variant:"success"});const b=p.get("redirectTo")||"/";setTimeout(()=>u(b),500)}else console.error("Unexpected Response Structure:",s),r({message:s.message||"Unexpected response. Please try again.",variant:"danger"})}catch(o){console.error("Login error:",o),r({message:"Login failed. Please try again.",variant:"danger"})}finally{i(!1)}};return e.jsxs(q,{onSubmit:f(x),children:[e.jsx(A,{name:"identifier",control:m,label:"Iqama Number or Member ID"}),e.jsx(F,{name:"password",control:m,label:"Password"}),e.jsx(R,{type:"submit",disabled:n,className:"w-100 mt-3",children:n?e.jsx(T,{animation:"border",size:"sm"}):"Sign In"})]})},ce=()=>e.jsx("div",{className:"account-pages p-sm-5 position-relative",children:e.jsx(D,{children:e.jsx(d,{className:"justify-content-center",children:e.jsx(t,{xxl:9,lg:11,children:e.jsx(E,{className:"overflow-hidden",children:e.jsxs(d,{className:"g-0",children:[e.jsx(t,{lg:6,children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx(I,{}),e.jsxs("div",{className:"p-4 my-auto text-center",children:[e.jsx("h4",{className:"fs-20",children:"Sign In"}),e.jsx("p",{className:"text-muted mb-4",children:"Enter your Iqama Number or Member ID and password to access your account."}),e.jsx(B,{})]})]})}),e.jsx(t,{lg:6,className:"d-none d-lg-block",children:e.jsx("img",{src:k,alt:"image",className:"img-fluid rounded h-100"})})]})})})})})});export{ce as default};
