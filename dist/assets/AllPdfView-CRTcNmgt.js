import{r as i,j as e,T as B,e as m,L as N}from"./index-BDB4q5H4.js";import{P as E}from"./PageTitle-KPq6Yc8N.js";import{a as P}from"./index-C88pvD_q.js";import{M as n}from"./Modal-nWjzETGZ.js";import{B as r}from"./Button-BMFIQuqA.js";import{S as L}from"./Spinner-CavDfVX6.js";import{R as u,C as o}from"./Row-BIfczcUC.js";import{P as c}from"./Pagination-CHZPiWyy.js";import"./AbstractModalHeader-RHl4kZG5.js";import"./useWindow-Cx76uDL4.js";import"./usePrevious-B6oOcbrv.js";import"./useEventCallback-B-mETKOe.js";import"./hasClass-spHkjNBt.js";import"./useMergedRefs-Bw5jdVLL.js";import"./NoopTransition-ogCn-ZiV.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-Cje9adg3.js";import"./Button-BvulfwIl.js";import"./Anchor-CV3PsB9I.js";const re=()=>{const[j,p]=i.useState([]),[d,A]=i.useState(""),[a,S]=i.useState(1),[g,C]=i.useState(1),[y,V]=i.useState(10),[T,l]=i.useState(!1),[v,D]=i.useState(null),[f,w]=i.useState(!1),[k,b]=i.useState(!1),[M,R]=i.useState(""),[_,F]=i.useState("success");i.useEffect(()=>{(async()=>{try{const s=await P.get(`http://185.199.53.88/api/invoice?page=${a}&limit=${y}&search=${d}`);s.status===200&&(p(s.data.data),C(s.data.pagination.totalPages))}catch(s){console.error("Error fetching PDFs:",s),x("Failed to fetch invoices. Please try again.","danger")}})()},[a,y,d]);const h=t=>{S(t)},I=t=>{D(t),l(!0)},$=async()=>{w(!0);try{(await P.delete(`http://185.199.53.88/api/invoice/${v}`)).status===200&&(p(j.filter(s=>s._id!==v)),x("Invoice deleted successfully!","success"))}catch(t){console.error("Error deleting invoice:",t),x("Failed to delete invoice. Please try again.","danger")}finally{w(!1),l(!1)}},x=(t,s)=>{R(t),F(s),b(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(E,{title:"All PDFs"}),e.jsx(B,{position:"top-end",className:"p-3",children:e.jsxs(m,{onClose:()=>b(!1),show:k,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(m.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(m.Body,{className:"",children:M})]})}),e.jsxs(n,{show:T,onHide:()=>l(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Confirm Delete"})}),e.jsx(n.Body,{children:"Are you sure you want to delete this invoice? This action cannot be undone."}),e.jsxs(n.Footer,{children:[e.jsx(r,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(r,{variant:"danger",onClick:$,disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(L,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(u,{children:e.jsx(o,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(u,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(o,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Company Name or Invoice Number",value:d,onChange:t=>A(t.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(o,{xs:"auto",children:e.jsx(r,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:N,to:"/invoice/new",children:"New"})})]}),e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Company Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Invoice Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Items"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Price"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:j.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.companyName}),e.jsx("td",{style:{verticalAlign:"middle"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.invoiceNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.items.length}),e.jsxs("td",{style:{verticalAlign:"middle"},children:["$",t.totalPrice]}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(r,{variant:"info",size:"sm",as:N,to:`/invoice/view/${t._id}`,style:{marginRight:"5px",color:"white"},children:"View"}),e.jsx(r,{variant:"danger",size:"sm",onClick:()=>I(t._id),children:"Delete"})]})]},s))})]})})})})}),e.jsx(u,{className:"mt-3",children:e.jsx(o,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(c,{children:[e.jsx(c.Prev,{onClick:()=>h(a-1),disabled:a===1}),Array.from({length:g},(t,s)=>e.jsx(c.Item,{active:s+1===a,onClick:()=>h(s+1),children:s+1},s+1)),e.jsx(c.Next,{onClick:()=>h(a+1),disabled:a===g})]})})})]})})})]})};export{re as default};
