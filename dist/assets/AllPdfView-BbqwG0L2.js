import{r as i,j as e,T as B,e as m,L as P}from"./index-BIHaN3sb.js";import{P as E}from"./PageTitle-1FlHDyJF.js";import{a as N}from"./index-C88pvD_q.js";import{M as n}from"./Modal-qaps3aIu.js";import{B as r}from"./Button-CuQYO7Ah.js";import{S as L}from"./Spinner-Bb3qiPgf.js";import{R as p,C as o}from"./Row-yYV4Yy1W.js";import{P as c}from"./Pagination-BE-amyZR.js";import"./AbstractModalHeader-BlQNGW--.js";import"./useWindow-CYw56gyB.js";import"./usePrevious-7tbD-594.js";import"./useEventCallback-DvjqFcxF.js";import"./hasClass-BIAy8CC6.js";import"./useMergedRefs-BcSw_4ay.js";import"./NoopTransition-BVfwRI-9.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-wfmF57ny.js";import"./Button-t0qNR9Tr.js";import"./Anchor-BMEenqBq.js";const re=()=>{const[u,j]=i.useState([]),[d,A]=i.useState(""),[a,S]=i.useState(1),[g,C]=i.useState(1),[y,V]=i.useState(10),[D,l]=i.useState(!1),[f,T]=i.useState(null),[v,w]=i.useState(!1),[k,b]=i.useState(!1),[F,M]=i.useState(""),[_,R]=i.useState("success");i.useEffect(()=>{(async()=>{try{const s=await N.get(`http://185.199.53.88/api/invoice?page=${a}&limit=${y}&search=${d}`);s.status===200&&(j(s.data.data),C(s.data.pagination.totalPages))}catch(s){console.error("Error fetching PDFs:",s),x("Failed to fetch invoices. Please try again.","danger")}})()},[a,y,d]);const h=t=>{S(t)},I=t=>{T(t),l(!0)},$=async()=>{w(!0);try{(await N.delete(`http://185.199.53.88/api/invoice/${f}`)).status===200&&(j(u.filter(s=>s._id!==f)),x("Invoice deleted successfully!","success"))}catch(t){console.error("Error deleting invoice:",t),x("Failed to delete invoice. Please try again.","danger")}finally{w(!1),l(!1)}},x=(t,s)=>{M(t),R(s),b(!0)};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(E,{title:"All PDFs"}),e.jsx(B,{position:"top-end",className:"p-3",children:e.jsxs(m,{onClose:()=>b(!1),show:k,delay:3e3,autohide:!0,bg:"white",children:[e.jsx(m.Header,{children:e.jsx("strong",{className:"me-auto",children:"Notification"})}),e.jsx(m.Body,{className:"",children:F})]})}),e.jsxs(n,{show:D,onHide:()=>l(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Confirm Delete"})}),e.jsx(n.Body,{children:"Are you sure you want to delete this invoice? This action cannot be undone."}),e.jsxs(n.Footer,{children:[e.jsx(r,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(r,{variant:"danger",onClick:$,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(L,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Deleting..."]}):"Delete"})]})]}),e.jsx(p,{children:e.jsx(o,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(p,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(o,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Company Name or Invoice Number",value:d,onChange:t=>A(t.target.value),style:{width:"250px",borderRadius:10}})}),e.jsx(o,{xs:"auto",children:e.jsx(r,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:P,to:"/pdf/new",children:"New PDF"})})]}),e.jsx("div",{children:e.jsx("div",{className:"responsive-table-plugin",children:e.jsx("div",{className:"table-rep-plugin",children:e.jsx("div",{className:"table-responsive","data-pattern":"priority-columns",children:e.jsxs("table",{id:"tech-companies-1",className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Company Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Invoice Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Items"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Price"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:u.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.companyName}),e.jsx("td",{style:{verticalAlign:"middle"},children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.invoiceNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.items.length}),e.jsxs("td",{style:{verticalAlign:"middle"},children:["$",t.totalPrice]}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(r,{variant:"info",size:"sm",as:P,to:`/pdf/view/${t._id}`,style:{marginRight:"5px",color:"white"},children:"View"}),e.jsx(r,{variant:"danger",size:"sm",onClick:()=>I(t._id),children:"Delete"})]})]},s))})]})})})})}),e.jsx(p,{className:"mt-3",children:e.jsx(o,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(c,{children:[e.jsx(c.Prev,{onClick:()=>h(a-1),disabled:a===1}),Array.from({length:g},(t,s)=>e.jsx(c.Item,{active:s+1===a,onClick:()=>h(s+1),children:s+1},s+1)),e.jsx(c.Next,{onClick:()=>h(a+1),disabled:a===g})]})})})]})})})]})};export{re as default};
